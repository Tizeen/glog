<!DOCTYPE html>
<html lang="zh-cn"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   <meta name="description" content="Docker 安装后，看到 docker0 网卡使用的是 172.17.0.1/16 网段，后续 Docker Run 运行起来不指定网络的容器，拿到的网络地址都是属于这个网段。
但是对于利用 Docker Compose 启动得到的容器，它们的 IP 地址并不是从 172.17.0.1/16 网段获取的，而是重新创建了一个虚拟网卡，分配了一个新的网给它的容器的使用。
默认 Docker Compose 会从 172.16.0.0/12 网络的地址范围 （172.16.0.0/16 ~ 172.31.255.255/16） 中挑选一个不重复的进行使用。但是有的时候 Docker Compose 挑选到的网络会和我们网络内其他网段冲突，就会导致容器和那个网络段的服务访问会有问题（路由会有问题），这个时候我们就要手动指定网段，解决网络冲突。
配置如下：

  version: &#39;3&#39;
services:
frontend:
image: frontend-app
networks:
- custom-network
backend:
image: backend-app
networks:
- custom-network
networks:
custom-network:
driver: bridge
ipam:
config:
- subnet: 192.168.250.0/24
">  

  <title>
    
      如何指定docker compose中容器的网段
    
  </title>


  <link rel="shortcut icon" type="image/x-icon" href="/" />
  
  
  
  <link rel="stylesheet" href="/css/main.900100e9dbee2d56c58fac8bb717037cae7e26a9c36c29d2ff587bdd65f0cbbe510b41d81a3bb234919cdfdc7550d786b2fab70c8fc507772d732fe097106d12.css" integrity="sha512-kAEA6dvuLVbFj6yLtxcDfK5&#43;JqnDbCnS/1h73WXwy75RC0HYGjuyNJGc39x1UNeGsvq3DI/FB3ctcy/glxBtEg==" />
  
</head>
<body a="auto">
        <main class="page-content" aria-label="Content">
            <div class="w">
<a href="/">..</a>


<article>
    <p class="post-meta">
        <time datetime="2024-04-19 01:56:19 &#43;0000 &#43;0000">
            2024-04-19
        </time>
    </p>

    <h1>如何指定docker compose中容器的网段</h1>

    

    <p>Docker 安装后，看到 <code>docker0</code> 网卡使用的是 <code>172.17.0.1/16</code> 网段，后续 <code>Docker Run</code> 运行起来不指定网络的容器，拿到的网络地址都是属于这个网段。</p>
<p>但是对于利用 Docker Compose 启动得到的容器，它们的 IP 地址并不是从 <code>172.17.0.1/16</code> 网段获取的，而是重新创建了一个虚拟网卡，分配了一个新的网给它的容器的使用。</p>
<p>默认 Docker Compose 会从 <code>172.16.0.0/12</code> 网络的地址范围 （<code>172.16.0.0/16</code> ~ <code>172.31.255.255/16）</code> 中挑选一个不重复的进行使用。但是有的时候 Docker Compose 挑选到的网络会和我们网络内其他网段冲突，就会导致容器和那个网络段的服务访问会有问题（路由会有问题），这个时候我们就要手动指定网段，解决网络冲突。</p>
<p>配置如下：</p>
<div class="hcb_wrap">
  <pre class="prism line-numbers lang-json" data-lang="JSON"><code>version: &#39;3&#39;
<p>services:
frontend:
image: frontend-app
networks:
- custom-network</p>
<p>backend:
image: backend-app
networks:
- custom-network</p>
<p>networks:
custom-network:
driver: bridge
ipam:
config:
- subnet: 192.168.250.0/24</code></pre></p>
</div>
</article>

                

            </div>
        </main>
    </body>
</html>
